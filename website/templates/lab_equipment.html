{% extends "index.html" %} {% block head %} {{ super() }}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/home.css') }}"
/>
<script>
  // Make user data available to JavaScript
  window.userData = {
    firstName: "{{ current_user.first_name }}",
    role: "{{ current_user.role.value|title }}",
    profilePicture: "{{ current_user.profile_picture or '' }}",
    homeUrl: "{{ url_for('home.home') }}",
  };
</script>
{% endblock %} {% block content %}

<body>
  <!-- NavBar -->
  <div id="navbar"></div>
  <!-- Breadcrumbs -->
  <div id="breadcrumbs"></div>

  <!-- table and features  -->
  <div class="container py-4">
    <h1>Lab Equipment</h1>

    <!-- search and filters -->
    <div class="search-filter-section mb-4">
      <div class="d-flex align-items-center gap-3">
        <!-- Search Bar -->
        <div class="search-bar-wrapper flex-grow-1">
          <div class="input-group">
            <span class="input-group-text search-icon">
              <i class="fas fa-search"></i>
            </span>
            <input
              type="text"
              id="search-input"
              class="form-control search-input"
              placeholder="Search by name, tags..."
              oninput="filterTable()"
            />
          </div>
        </div>

        <!-- Filter Button -->
        <button
          type="button"
          class="btn btn-outline-secondary filter-btn"
          data-bs-toggle="collapse"
          data-bs-target="#filterCollapse"
          aria-expanded="false"
          aria-controls="filterCollapse"
        >
          <i class="fas fa-filter me-2"></i>Filter
        </button>

        <!-- Add Item Button -->
        {% if current_user.role.value != 'student' %}
        <button
          id="openAddItemBtn"
          class="btn btn-primary add-item-btn"
          data-bs-toggle="modal"
          data-bs-target="#addItemModal"
        >
          <i class="fas fa-plus me-2"></i>Add Item
        </button>
        {% endif %}
      </div>

      <!-- Collapsible Filter Section -->
      <div class="collapse mt-3" id="filterCollapse">
        <div class="card card-body filter-panel">
          <div class="row g-3">
            <div class="col-md-4">
              <label for="filter-name" class="form-label small fw-semibold"
                >Name</label
              >
              <input
                type="text"
                id="filter-name"
                class="form-control"
                placeholder="Filter by name"
                oninput="filterTable()"
              />
            </div>
            <div class="col-md-4">
              <label for="filter-tags" class="form-label small fw-semibold"
                >Tags</label
              >
              <input
                type="text"
                id="filter-tags"
                class="form-control"
                placeholder="Tags (comma-separated)"
                oninput="filterTable()"
              />
            </div>
            <div class="col-md-4">
              <label
                for="filter-service-frequency"
                class="form-label small fw-semibold"
                >Service Frequency</label
              >
              <select
                id="filter-service-frequency"
                class="form-select"
                onchange="filterTable()"
              >
                <option value="">All</option>
                <option value="weekly">Weekly</option>
                <option value="bi-weekly">Bi-Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly</option>
                <option value="yearly">Yearly</option>
                <option value="as-needed">As Needed</option>
              </select>
            </div>
            <div class="col-12">
              <button
                type="button"
                class="btn btn-sm btn-outline-secondary"
                onclick="clearFilters()"
              >
                <i class="fas fa-times me-1"></i>Clear Filters
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Table Section -->
    <div class="row g-3">
      <div class="col-sm-12 col-lg-12">
        <div class="card h-100">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle">
                <thead class="table-light">
                  <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Tags</th>
                    <th scope="col">Service Frequency</th>
                    <th scope="col">Last Serviced</th>
                    <th scope="col">Last Serviced By</th>
                    <th scope="col">Last updated</th>
                    <th scope="col" class="text-end" style="width: 60px">
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody id="lab-equipment-table-body"></tbody>
              </table>
            </div>
            <div id="pagination-container"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% include 'add_item_modal.html' %} {% include 'notes_modal.html' %}

  <!-- Delete Confirmation Modal -->
  <div
    class="modal fade"
    id="deleteConfirmModal"
    tabindex="-1"
    aria-labelledby="deleteConfirmModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteConfirmModalLabel">
            <i class="fas fa-exclamation-triangle text-danger me-2"></i>Confirm
            Deletion
          </h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <p>
            Are you sure you want to delete this item? This action cannot be
            undone.
          </p>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cancel
          </button>
          <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
            Delete Item
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/componenets/Navbar.js') }}"></script>
  <script src="{{ url_for('static', filename='js/componenets/Breadcrumbs.js') }}"></script>
  <script src="{{ url_for('static', filename='js/componenets/LabRow.js') }}"></script>
  <script src="{{ url_for('static', filename='js/utils/index.js') }}"></script>
  <script src="/static/js/pagination.js"></script>
  <script src="/static/js/notes.js"></script>
  <script src="/static/js/labEquipment.js"></script>
</body>
{% endblock %}
